<?xml version="1.0" encoding="UTF-8"?>
<dataTemplate name="XXUPHR_HC_CORE_NONCORE_INDI" description="UP HR Headcount - Core and Non Core Personnel Individual" defaultPackage="" Version="1.0">
<parameters>
   <parameter name="P_EFF_DATE" dataType="date" />
   <parameter name="P_CU" dataType ="number"/>
</parameters>

<dataQuery>

<sqlStatement name="Q_PPG">
<![CDATA[
SELECT SUBSTR(admin.cu, INSTR(admin.cu, ' ') + 1) cu
      ,nvl(fac, 0) fac
      ,nvl(admin, 0) admin
      ,nvl(reps, 0) reps
      ,nvl(rfe, 0) rfe
      ,nvl(fac,0) + nvl(admin,0) + nvl(reps,0) + nvl(rfe,0) tcu
FROM
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END fac
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                  
        ,'PT Casual'                  
                
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) fac
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END admin
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                  
        ,'PT Casual'                  
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) admin
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END reps
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                  
        ,'PT Casual'                  
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) reps
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id           
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')            
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')               
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')                 
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Adjunct%')                                      
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                  
                            ,'FT Temporary'                 
                            ,'PT Temporary'                 
                            , 'FT Substitute'                 
                            ,'PT Substitute'                  
                            ,'FT Casual'                  
                            ,'PT Casual'                  
                            ,'FT Contractual'                 
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END rfe
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                    
        ,'PT Casual'                  
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) rfe
WHERE admin.cu = fac.cu (+)
AND admin.cu = reps.cu (+)
AND admin.cu = rfe.cu (+)
AND admin.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(admin.cu, 'UP System'                       ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )

]]>
</sqlStatement>
        


<sqlStatement name="Q_CATEG">
<![CDATA[

SELECT SUBSTR(perm.cu, INSTR(perm.cu, ' ') + 1) cu
      ,NVL(perm, 0) perm
      ,NVL(temp, 0) temp
      ,NVL(subs, 0) subs
      ,NVL(casl, 0) casl
      ,NVL(cont, 0) cont
      ,nvl(perm,0) + nvl(temp,0) + nvl(subs,0) + nvl(casl,0) + nvl(cont,0) tcu
FROM      
(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            ,'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END perm
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                                 
        ))
GROUP BY hsck.concatenated_segments
) perm
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END temp
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id NOT IN (SELECT position_id
                      FROM per_all_positions pap                 
                      WHERE   pap.name LIKE '%Lecturer%')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                      
        'FT Temporary'                  
        ,'PT Temporary'                         
        ))
GROUP BY hsck.concatenated_segments
) temp
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END subs
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                              
        'FT Substitute'
        ,'PT Substitute'
        ))
GROUP BY hsck.concatenated_segments
) subs
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END casl
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                               
        'FT Casual'                 
        ,'PT Casual'                  
        ))
GROUP BY hsck.concatenated_segments
) casl
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END cont
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                             
        'FT Contractual'                  
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) cont
WHERE perm.cu = temp.cu (+)
AND perm.cu = subs.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = cont.cu (+)
AND perm.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(perm.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )
]]>

</sqlStatement>                




<sqlStatement name="Q_REPS_CATEG">
<![CDATA[

SELECT SUBSTR(perm.cu, INSTR(perm.cu, ' ') + 1) cu
      ,NVL(perm, 0) perm
      ,NVL(temp, 0) temp
      ,NVL(subs, 0) subs
      ,NVL(casl, 0) casl
      ,NVL(cont, 0) cont
      ,nvl(perm,0) + nvl(temp,0) + nvl(subs,0) + nvl(casl,0) + nvl(cont,0) tcu
FROM
(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'
                      AND papf.person_type_id = 1126
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV
                            WHERE LOOKUP_TYPE = 'EMP_CAT'
                            AND ENABLED_FLAG = 'Y'
                            AND FLV.MEANING IN (
                            'FT Permanent'                  
                            ,'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END perm
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                                 
        ))
GROUP BY hsck.concatenated_segments
) perm
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END temp
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'             
  AND papf.person_type_id = 1126
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
  AND paaf.position_id NOT IN (SELECT position_id
                      FROM per_all_positions pap                 
                      WHERE   pap.name LIKE '%Lecturer%')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                      
        'FT Temporary'                  
        ,'PT Temporary'                         
        ))
GROUP BY hsck.concatenated_segments
) temp
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END subs
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                              
        'FT Substitute'
        ,'PT Substitute'
        ))
GROUP BY hsck.concatenated_segments
) subs
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END casl
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                               
        'FT Casual'                 
        ,'PT Casual'                  
        ))
GROUP BY hsck.concatenated_segments
) casl
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END cont
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.REPS (Research/Extension/ Professionals)')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                             
        'FT Contractual'                  
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) cont
WHERE perm.cu = temp.cu (+)
AND perm.cu = subs.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = cont.cu (+)
AND perm.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(perm.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )


]]>
</sqlStatement>

<sqlStatement name="Q_ADMIN_CATEG">
<![CDATA[


SELECT SUBSTR(perm.cu, INSTR(perm.cu, ' ') + 1) cu
      ,NVL(perm, 0) perm
      ,NVL(temp, 0) temp
      ,NVL(subs, 0) subs
      ,NVL(casl, 0) casl
      ,NVL(cont, 0) cont
      ,nvl(perm,0) + nvl(temp,0) + nvl(subs,0) + nvl(casl,0) + nvl(cont,0) tcu
FROM      
(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV
                            WHERE LOOKUP_TYPE = 'EMP_CAT'
                            AND ENABLED_FLAG = 'Y'
                            AND FLV.MEANING IN (
                            'FT Permanent'                  
                            ,'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END perm
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                                 
        ))
GROUP BY hsck.concatenated_segments
) perm
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END temp
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'             
  AND papf.person_type_id = 1126
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id
                      FROM per_all_positions pap                 
                      WHERE   pap.name LIKE '%Lecturer%')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                      
        'FT Temporary'                  
        ,'PT Temporary'                         
        ))
GROUP BY hsck.concatenated_segments
) temp
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END subs
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                              
        'FT Substitute'
        ,'PT Substitute'
        ))
GROUP BY hsck.concatenated_segments
) subs
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END casl
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                               
        'FT Casual'                 
        ,'PT Casual'                  
        ))
GROUP BY hsck.concatenated_segments
) casl
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END cont
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Non-Academic.'
                        ,'Non-Academic.PGH Fiscal'
                        ,'Non-Academic.PGH Health Operations'
                        ,'Non-Academic.PGH Nursing'
                        ,'Non-Academic.PGH Administrative'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                             
        'FT Contractual'                  
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) cont
WHERE perm.cu = temp.cu (+)
AND perm.cu = subs.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = cont.cu (+)
AND perm.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(perm.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )
]]>
</sqlStatement>


<sqlStatement name="Q_FAC_CATEG">
<![CDATA[
SELECT SUBSTR(perm.cu, INSTR(perm.cu, ' ') + 1) cu
      ,NVL(perm, 0) perm
      ,NVL(temp, 0) temp
      ,NVL(subs, 0) subs
      ,NVL(casl, 0) casl
      ,NVL(cont, 0) cont
      ,nvl(perm,0) + nvl(temp,0) + nvl(subs,0) + nvl(casl,0) + nvl(cont,0) tcu
FROM      
(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                             )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV
                            WHERE LOOKUP_TYPE = 'EMP_CAT'
                            AND ENABLED_FLAG = 'Y'
                            AND FLV.MEANING IN (
                            'FT Permanent'                  
                            ,'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END perm
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                                 
        ))
GROUP BY hsck.concatenated_segments
) perm
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END temp
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'             
  AND papf.person_type_id = 1126
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id
                      FROM per_all_positions pap                 
                      WHERE   pap.name LIKE '%Lecturer%')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                      
        'FT Temporary'                  
        ,'PT Temporary'                         
        ))
GROUP BY hsck.concatenated_segments
) temp
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END subs
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                              
        'FT Substitute'
        ,'PT Substitute'
        ))
GROUP BY hsck.concatenated_segments
) subs
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END casl
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                               
        'FT Casual'                 
        ,'PT Casual'                  
        ))
GROUP BY hsck.concatenated_segments
) casl
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.group_name IN ('Academic.Faculty'
                                            ,'Academic.'
                                            )
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END cont
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Faculty'
                        ,'Academic.'
                        )
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                             
        'FT Contractual'                  
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) cont
WHERE perm.cu = temp.cu (+)
AND perm.cu = subs.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = cont.cu (+)
AND perm.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(perm.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )

]]>

</sqlStatement>

<sqlStatement name="Q_RFE_CATEG">
<![CDATA[


SELECT SUBSTR(perm.cu, INSTR(perm.cu, ' ') + 1) cu
      ,NVL(perm, 0) perm
      ,NVL(temp, 0) temp
      ,NVL(subs, 0) subs
      ,NVL(casl, 0) casl
      ,NVL(cont, 0) cont
      ,nvl(perm,0) + nvl(temp,0) + nvl(subs,0) + nvl(casl,0) + nvl(cont,0) tcu
FROM      
(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                  
                            'FT Permanent'                  
                            , 'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV
                            WHERE LOOKUP_TYPE = 'EMP_CAT'
                            AND ENABLED_FLAG = 'Y'
                            AND FLV.MEANING IN (
                            'FT Permanent'                  
                            ,'PT Permanent'                                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END perm
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                                 
        ))
GROUP BY hsck.concatenated_segments
) perm
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                      
                            'FT Temporary'                  
                            ,'PT Temporary'                         
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END temp
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'             
  AND papf.person_type_id = 1126
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
  AND paaf.position_id NOT IN (SELECT position_id
                      FROM per_all_positions pap                 
                      WHERE   pap.name LIKE '%Lecturer%')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                      
        'FT Temporary'                  
        ,'PT Temporary'                         
        ))
GROUP BY hsck.concatenated_segments
) temp
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Lecturer%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap
                                          WHERE   pap.name LIKE '%Fellow%')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                              
                            'FT Substitute'
                            ,'PT Substitute'
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END subs
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                              
        'FT Substitute'
        ,'PT Substitute'
        ))
GROUP BY hsck.concatenated_segments
) subs
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                               
                            'FT Casual'                 
                            ,'PT Casual'                  
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END casl
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                               
        'FT Casual'                 
        ,'PT Casual'                  
        ))
GROUP BY hsck.concatenated_segments
) casl
,(SELECT  hsck.concatenated_segments cu
         ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.people_group_id = paaf.people_group_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                      GROUP BY hsck.concatenated_segments
                    )
               WHEN hsck.concatenated_segments = 'UP Visayas'
               THEN (SELECT SUM(COUNT(1))
                     FROM hr.per_all_people_f papf                 
                        ,hr.per_all_assignments_f paaf
                        ,hr.pay_people_groups ppg
                        ,hr.hr_soft_coding_keyflex hsck
                    WHERE papf.person_id = paaf.person_id                 
                      AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                      AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                      AND paaf.primary_flag = 'Y'                 
                      AND papf.person_type_id = 1126            
                      AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
                      AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
                      AND ppg.people_group_id = paaf.people_group_id
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Lecturer%')          
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Fellow%')              
                      AND paaf.position_id NOT IN (SELECT position_id                 
                                          FROM per_all_positions pap                  
                                          WHERE   pap.name LIKE '%Visiting%')
                      AND paaf.position_id NOT IN (SELECT position_id
                                          FROM per_all_positions pap      
                                          WHERE   pap.name LIKE '%Adjunct%')
                      AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                            FROM FND_LOOKUP_VALUES FLV                  
                            WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                            AND ENABLED_FLAG = 'Y'                  
                            AND FLV.MEANING IN (                             
                            'FT Contractual'                  
                            ,'PT Contractual'                 
                            ))
                      AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                      GROUP BY hsck.concatenated_segments
                    )
               ELSE COUNT(1)
               END cont
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND ppg.group_name IN ('Academic.Research Faculty/Extension Faculty')
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                             
        'FT Contractual'                  
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) cont
WHERE perm.cu = temp.cu (+)
AND perm.cu = subs.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = casl.cu (+)
AND perm.cu = cont.cu (+)
AND perm.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(perm.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )

]]>
</sqlStatement>



<sqlStatement name="Q_GENDER">
<![CDATA[

SELECT SUBSTR(male.cu, INSTR(male.cu, ' ') + 1) cu
      ,NVL(male,0) male
      ,NVL(female,0) female
      ,NVL(male,0) + NVL(female,0) tcu
FROM
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
            THEN (SELECT SUM(COUNT(1))
            FROM hr.per_all_people_f papf                 
                ,hr.per_all_assignments_f paaf
                ,hr.pay_people_groups ppg
                ,hr.hr_soft_coding_keyflex hsck
            WHERE papf.person_id = paaf.person_id                 
              AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
              AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
              AND paaf.primary_flag = 'Y'                 
              AND papf.person_type_id = 1126            
              AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
              AND ppg.people_group_id = paaf.people_group_id
              AND papf.sex = 'M'
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Lecturer%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Fellow%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Visiting%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Adjunct%')                                      
              AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                    FROM FND_LOOKUP_VALUES FLV                  
                    WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                    AND ENABLED_FLAG = 'Y'                  
                    AND FLV.MEANING IN (                  
                    'FT Permanent'                  
                    , 'PT Permanent'                  
                    ,'FT Temporary'                 
                    ,'PT Temporary'                 
                    , 'FT Substitute'                 
                    ,'PT Substitute'                  
                    ,'FT Casual'                  
                    ,'PT Casual'                  
                    ,'FT Contractual'                 
                    ,'PT Contractual'                 
                    ))
            AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
            GROUP BY hsck.concatenated_segments
            )
            WHEN hsck.concatenated_segments = 'UP Visayas'
            THEN (SELECT SUM(COUNT(1))
            FROM hr.per_all_people_f papf                 
                ,hr.per_all_assignments_f paaf
                ,hr.pay_people_groups ppg
                ,hr.hr_soft_coding_keyflex hsck
            WHERE papf.person_id = paaf.person_id                 
              AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
              AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
              AND paaf.primary_flag = 'Y'                 
              AND papf.person_type_id = 1126            
              AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
              AND ppg.people_group_id = paaf.people_group_id
              AND papf.sex = 'M'
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Lecturer%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Fellow%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Visiting%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Adjunct%')                                      
              AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                    FROM FND_LOOKUP_VALUES FLV                  
                    WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                    AND ENABLED_FLAG = 'Y'                  
                    AND FLV.MEANING IN (                  
                    'FT Permanent'                  
                    , 'PT Permanent'                  
                    ,'FT Temporary'                 
                    ,'PT Temporary'                 
                    , 'FT Substitute'                 
                    ,'PT Substitute'                  
                    ,'FT Casual'                  
                    ,'PT Casual'                  
                    ,'FT Contractual'                 
                    ,'PT Contractual'                 
                    ))
            AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
            GROUP BY hsck.concatenated_segments
            )
            ELSE COUNT(1)
            END male
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND papf.sex = 'M'
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                  
        ,'PT Casual'                  
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) male
,(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos'
            THEN (SELECT SUM(COUNT(1))
            FROM hr.per_all_people_f papf                 
                ,hr.per_all_assignments_f paaf
                ,hr.pay_people_groups ppg
                ,hr.hr_soft_coding_keyflex hsck
            WHERE papf.person_id = paaf.person_id                 
              AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
              AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
              AND paaf.primary_flag = 'Y'                 
              AND papf.person_type_id = 1126            
              AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
              AND ppg.people_group_id = paaf.people_group_id
              AND papf.sex = 'F'
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Lecturer%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Fellow%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Visiting%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Adjunct%')                                      
              AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                    FROM FND_LOOKUP_VALUES FLV                  
                    WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                    AND ENABLED_FLAG = 'Y'                  
                    AND FLV.MEANING IN (                  
                    'FT Permanent'                  
                    , 'PT Permanent'                  
                    ,'FT Temporary'                 
                    ,'PT Temporary'                 
                    , 'FT Substitute'                 
                    ,'PT Substitute'                  
                    ,'FT Casual'                  
                    ,'PT Casual'                  
                    ,'FT Contractual'                 
                    ,'PT Contractual'                 
                    ))
            AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
            GROUP BY hsck.concatenated_segments
            )
            WHEN hsck.concatenated_segments = 'UP Visayas'
            THEN (SELECT SUM(COUNT(1))
            FROM hr.per_all_people_f papf                 
                ,hr.per_all_assignments_f paaf
                ,hr.pay_people_groups ppg
                ,hr.hr_soft_coding_keyflex hsck
            WHERE papf.person_id = paaf.person_id                 
              AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
              AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
              AND paaf.primary_flag = 'Y'                 
              AND papf.person_type_id = 1126            
              AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
              AND ppg.people_group_id = paaf.people_group_id
              AND papf.sex = 'F'
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Lecturer%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Fellow%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Visiting%')                 
              AND paaf.position_id NOT IN (SELECT position_id                 
                                  FROM per_all_positions pap                  
                                  WHERE   pap.name LIKE '%Adjunct%')                                      
              AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                    FROM FND_LOOKUP_VALUES FLV                  
                    WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                    AND ENABLED_FLAG = 'Y'                  
                    AND FLV.MEANING IN (                  
                    'FT Permanent'                  
                    , 'PT Permanent'                  
                    ,'FT Temporary'                 
                    ,'PT Temporary'                 
                    , 'FT Substitute'                 
                    ,'PT Substitute'                  
                    ,'FT Casual'                  
                    ,'PT Casual'                  
                    ,'FT Contractual'                 
                    ,'PT Contractual'                 
                    ))
            AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
            GROUP BY hsck.concatenated_segments
            )
            ELSE COUNT(1)
            END female
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id
  AND ppg.people_group_id = paaf.people_group_id
  AND papf.sex = 'F'
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Fellow%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
  AND paaf.position_id NOT IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                                      
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'FT Permanent'                  
        , 'PT Permanent'                  
        ,'FT Temporary'                 
        ,'PT Temporary'                 
        , 'FT Substitute'                 
        ,'PT Substitute'                  
        ,'FT Casual'                  
        ,'PT Casual'                  
        ,'FT Contractual'                 
        ,'PT Contractual'                 
        ))
GROUP BY hsck.concatenated_segments
) female
WHERE male.cu = female.cu (+)
AND male.cu NOT IN ('UPV Tacloban College DO NOT USE', 'UPV Tacloban College', 'UPLB La Granja Research and Training Station')
ORDER BY DECODE(male.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                        )

]]>
</sqlStatement>




<sqlStatement name="Q_NONCORE_NO_PGH">
<![CDATA[

SELECT SUBSTR(ics.cu, INSTR(ics.cu, ' ') + 1) cu
      ,nvl(ics,0) ics
      ,nvl(woc,0) woc
      ,nvl(lec,0) lec
      ,nvl(aff,0) aff
      ,nvl(vis,0) vis
      ,nvl(adj,0) adj
      ,nvl(eme,0) eme
      ,nvl(lec,0) + nvl(aff,0) + nvl(vis,0) + nvl(adj,0) + nvl(eme,0)  taf --total additional faculty
      ,nvl(ics,0) + nvl(woc,0) tiw --total woc and ics
      ,nvl(lec,0) + nvl(aff,0) + nvl(vis,0) + nvl(adj,0) + nvl(eme,0) + nvl(ics,0) + nvl(woc,0) tnc --total noncore
FROM 
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                          FROM FND_LOOKUP_VALUES FLV                  
                          WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                          AND ENABLED_FLAG = 'Y'                  
                          AND FLV.MEANING IN (                  
                          'Individual Contract of Services'
                          ))
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                          FROM FND_LOOKUP_VALUES FLV                  
                          WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                          AND ENABLED_FLAG = 'Y'                  
                          AND FLV.MEANING IN (                  
                          'Individual Contract of Services'
                          ))
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END ics
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'Individual Contract of Services'
        ))
GROUP BY hsck.concatenated_segments
) ics
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                                                      FROM FND_LOOKUP_VALUES FLV                  
                                                      WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                                                      AND ENABLED_FLAG = 'Y'                  
                                                      AND FLV.MEANING IN (                  
                                                      'WOC'             
                                                      ))
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                                                      FROM FND_LOOKUP_VALUES FLV                  
                                                      WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                                                      AND ENABLED_FLAG = 'Y'                  
                                                      AND FLV.MEANING IN (                  
                                                      'WOC'             
                                                      ))
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END woc
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'WOC'             
        ))             
GROUP BY hsck.concatenated_segments
) woc
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                             FROM per_all_positions pap                  
                                             WHERE   pap.name LIKE '%Lecturer%')
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                             FROM per_all_positions pap                  
                                             WHERE   pap.name LIKE '%Lecturer%')  
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END lec
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE pap.name LIKE '%Lecturer%')                 
GROUP BY hsck.concatenated_segments
) lec
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                             
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                            FROM per_all_positions pap                  
                                            WHERE   pap.name LIKE '%Affiliate%')
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                        
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                            FROM per_all_positions pap                  
                                            WHERE   pap.name LIKE '%Affiliate%')  
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END aff
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
--  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Affiliate%')                 
GROUP BY hsck.concatenated_segments
) aff
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                             
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                            FROM per_all_positions pap                  
                                            WHERE   pap.name LIKE '%Visiting%')    
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                        
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                            FROM per_all_positions pap                  
                                            WHERE   pap.name LIKE '%Visiting%')      
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END vis
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
GROUP BY hsck.concatenated_segments
) vis
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                             
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                            FROM per_all_positions pap                  
                                            WHERE   pap.name LIKE '%Adjunct%')      
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                        
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.position_id IN (SELECT position_id                 
                                              FROM per_all_positions pap                  
                                              WHERE   pap.name LIKE '%Adjunct%')          
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END adj
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'
  AND papf.person_type_id = 1126
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                 
GROUP BY hsck.concatenated_segments
) adj
,
(SELECT hsck.concatenated_segments cu
      ,CASE WHEN hsck.concatenated_segments = 'UP Los Banos' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                                                      FROM FND_LOOKUP_VALUES FLV                  
                                                      WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                                                      AND ENABLED_FLAG = 'Y'                  
                                                      AND FLV.MEANING IN (                  
                                                      'Emeritus'             
                                                      ))
                    AND hsck.concatenated_segments IN ('UP Los Banos','UPLB La Granja Research and Training Station')
                    GROUP BY hsck.concatenated_segments
                    )
            WHEN hsck.concatenated_segments = 'UP Visayas' 
            THEN (SELECT SUM(COUNT(1))
                  FROM hr.per_all_people_f papf
                      ,hr.per_all_assignments_f paaf
                      ,hr.pay_people_groups ppg
                      ,hr.hr_soft_coding_keyflex hsck
                  WHERE papf.person_id = paaf.person_id                 
                    AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
                    AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
                    AND paaf.primary_flag = 'Y'                 
                    AND papf.person_type_id = 1126            
                    AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
                    AND ppg.people_group_id = paaf.people_group_id
                    AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                                                      FROM FND_LOOKUP_VALUES FLV                  
                                                      WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                                                      AND ENABLED_FLAG = 'Y'                  
                                                      AND FLV.MEANING IN (                  
                                                      'Emeritus'             
                                                      ))
                    AND hsck.concatenated_segments IN ('UP Visayas','UPV Tacloban College')
                    GROUP BY hsck.concatenated_segments
                    )
            ELSE COUNT(1)
            END eme
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'Emeritus'             
        ))                             
GROUP BY hsck.concatenated_segments
) eme
WHERE ics.cu = lec.cu (+)
AND ics.cu = woc.cu (+)
AND ics.cu = aff.cu (+)
AND ics.cu = vis.cu (+)
AND ics.cu = adj.cu (+)
AND ics.cu = eme.cu (+)
AND ics.cu NOT IN ('UP Visayas Tacloban College DO NOT USE', 'UPV Tacloban College DO NOT USE' ,'UPV Tacloban College', 'UPLB La Granja Research and Training Station', 'UP Philippine General Hospital')
ORDER BY DECODE(ics.cu, 'UP System'                        ,1
                        , 'UP Diliman'                      ,2
                        , 'UP Los Banos'                    ,3
                        , 'UP Manila'                       ,4
                        , 'UP Visayas'                      ,5
                        , 'UP Open University'              ,6
                        , 'UP Mindanao'                     ,7
                        , 'UP Baguio'                       ,8
                        , 'UP Cebu'                         ,9
                        , 'UP Philippine General Hospital', 10
                        , 11
                )

]]>

</sqlStatement>

<sqlStatement name="Q_NONCORE_PGH">
<![CDATA[
SELECT ics.cu    
      ,nvl(ics,0) ics
      ,nvl(woc,0) woc
      ,nvl(lec,0) lec
      ,nvl(aff,0) aff
      ,nvl(vis,0) vis
      ,nvl(adj,0) adj
      ,nvl(eme,0) eme
      ,nvl(lec,0) + nvl(aff,0) + nvl(vis,0) + nvl(adj,0) + nvl(eme,0)  taf --total additional faculty
      ,nvl(ics,0) + nvl(woc,0) tiw --total woc and ics
      ,nvl(lec,0) + nvl(aff,0) + nvl(vis,0) + nvl(adj,0) + nvl(eme,0) + nvl(ics,0) + nvl(woc,0) tnc --total noncore
FROM 
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) ics
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'Individual Contract of Services'             
        ))             
GROUP BY hsck.concatenated_segments
) ics
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) woc
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'WOC'             
        ))             
GROUP BY hsck.concatenated_segments
) woc
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) lec
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Lecturer%')                 
GROUP BY hsck.concatenated_segments
) lec
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) aff
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Affiliate%')                 
GROUP BY hsck.concatenated_segments
) aff
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) vis
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Visiting%')                 
GROUP BY hsck.concatenated_segments
) vis
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) adj
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.position_id IN (SELECT position_id                 
                      FROM per_all_positions pap                  
                      WHERE   pap.name LIKE '%Adjunct%')                 
GROUP BY hsck.concatenated_segments
) adj
,
(SELECT hsck.concatenated_segments cu
      ,COUNT(1) eme
FROM hr.per_all_people_f papf                 
    ,hr.per_all_assignments_f paaf
    ,hr.pay_people_groups ppg
    ,hr.hr_soft_coding_keyflex hsck
WHERE papf.person_id = paaf.person_id                 
  AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
  AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
  AND paaf.primary_flag = 'Y'                 
  AND papf.person_type_id = 1126            
  AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
  AND ppg.people_group_id = paaf.people_group_id
  AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
        FROM FND_LOOKUP_VALUES FLV                  
        WHERE LOOKUP_TYPE = 'EMP_CAT'                 
        AND ENABLED_FLAG = 'Y'                  
        AND FLV.MEANING IN (                  
        'Emeritus'             
        ))                             
GROUP BY hsck.concatenated_segments
) eme
WHERE ics.cu = lec.cu (+)
AND ics.cu = woc.cu (+)
AND ics.cu = aff.cu (+)
AND ics.cu = vis.cu (+)
AND ics.cu = adj.cu (+)
AND ics.cu = eme.cu (+)
AND ics.cu = 'UP Philippine General Hospital'

]]>

</sqlStatement>

<sqlStatement name="Q_HEADER">
<![CDATA[

SELECT (SELECT concatenated_segments
        FROM hr.hr_soft_coding_keyflex
        WHERE segment1 = :P_CU) cu
      ,to_char(:P_EFF_DATE,'DD FMMonth YYYY') eff_date 
      ,LPAD(TO_CHAR(xxup_seq_HC.NEXTVAL),9,'0')  seq 
      ,(SELECT NVL(total_1.tiw,0) + NVL(total_2.taf,0) total_s1_s2
        FROM
        (SELECT COUNT(1) tiw
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
          AND ppg.people_group_id = paaf.people_group_id
          AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                FROM FND_LOOKUP_VALUES FLV                  
                WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                AND ENABLED_FLAG = 'Y'                  
                AND FLV.MEANING IN (                  
                'Individual Contract of Services'           
                ,'WOC'
                ,'Emeritus'
                ))
          AND hsck.concatenated_segments NOT IN ('UPV Tacloban College DO NOT USE', 'UP Visayas Tacloban College DO NOT USE', 'UP Philippine General Hospital')
        ) total_1
        ,
        (
        SELECT COUNT(1) taf
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id 
          AND ppg.people_group_id = paaf.people_group_id
          AND (paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Lecturer%')
          OR paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Affiliate%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Visiting%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Adjunct%')
          )
          AND hsck.concatenated_segments NOT IN ('UPV Tacloban College DO NOT USE', 'UP Visayas Tacloban College DO NOT USE', 'UP Philippine General Hospital')
        ) total_2) t_npgh
       ,(SELECT NVL(total_1.tiw,0) + NVL(total_2.taf,0) total_s1_s2
        FROM
        (SELECT COUNT(1) tiw
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
          AND ppg.people_group_id = paaf.people_group_id
          AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                FROM FND_LOOKUP_VALUES FLV                  
                WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                AND ENABLED_FLAG = 'Y'                  
                AND FLV.MEANING IN (                  
                'Individual Contract of Services'           
                ,'WOC'
                ,'Emeritus'
                ))
          AND hsck.concatenated_segments = 'UP Philippine General Hospital'
        ) total_1
        ,
        (
        SELECT COUNT(1) taf
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id 
          AND ppg.people_group_id = paaf.people_group_id
          AND (paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Lecturer%')
          OR paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Affiliate%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Visiting%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Adjunct%')
          )
          AND hsck.concatenated_segments = 'UP Philippine General Hospital'
        ) total_2) t_pgh
        ,(SELECT total_1.tiw + total_2.taf + total_pgh_1.tiw + total_pgh_2.taf
        FROM
        (SELECT COUNT(1) tiw
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
          AND ppg.people_group_id = paaf.people_group_id
          AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                FROM FND_LOOKUP_VALUES FLV                  
                WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                AND ENABLED_FLAG = 'Y'                  
                AND FLV.MEANING IN (                  
                'Individual Contract of Services'           
                ,'WOC'
                ,'Emeritus'
                ))
          AND hsck.concatenated_segments NOT IN ('UPV Tacloban College DO NOT USE', 'UP Visayas Tacloban College DO NOT USE', 'UP Philippine General Hospital')
        ) total_1
        ,
        (
        SELECT COUNT(1) taf
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id 
          AND ppg.people_group_id = paaf.people_group_id
          AND (paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Lecturer%')
          OR paaf.position_id IN (SELECT position_id
                                    FROM per_all_positions pap
                                    WHERE   pap.name LIKE '%Affiliate%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Visiting%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Adjunct%')
          )
          AND hsck.concatenated_segments NOT IN ('UPV Tacloban College DO NOT USE', 'UP Visayas Tacloban College DO NOT USE', 'UP Philippine General Hospital')
        ) total_2
        ,
        (SELECT COUNT(1) tiw
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id (+)
          AND ppg.people_group_id = paaf.people_group_id
          AND paaf.EMPLOYMENT_CATEGORY IN (SELECT FLV.LOOKUP_CODE   
                FROM FND_LOOKUP_VALUES FLV                  
                WHERE LOOKUP_TYPE = 'EMP_CAT'                 
                AND ENABLED_FLAG = 'Y'                  
                AND FLV.MEANING IN (                  
                'Individual Contract of Services'           
                ,'WOC'
                ,'Emeritus'
                ))
          AND hsck.concatenated_segments = 'UP Philippine General Hospital'
        ) total_pgh_1
        ,
        (
        SELECT COUNT(1) taf
        FROM hr.per_all_people_f papf                 
            ,hr.per_all_assignments_f paaf
            ,hr.pay_people_groups ppg
            ,hr.hr_soft_coding_keyflex hsck
        WHERE papf.person_id = paaf.person_id                 
          AND :P_EFF_DATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date                  
          AND :P_EFF_DATE BETWEEN papf.effective_start_date AND papf.effective_end_date                  
          AND paaf.primary_flag = 'Y'                 
          AND papf.person_type_id = 1126            
          AND paaf.soft_coding_keyflex_id = hsck.soft_coding_keyflex_id 
          AND ppg.people_group_id = paaf.people_group_id
          AND (paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Lecturer%')
          OR paaf.position_id IN (SELECT position_id                 
                                    FROM per_all_positions pap                  
                                    WHERE   pap.name LIKE '%Affiliate%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Visiting%')
          OR paaf.position_id IN (SELECT position_id                 
                              FROM per_all_positions pap                  
                              WHERE   pap.name LIKE '%Adjunct%')
          )
          AND hsck.concatenated_segments = 'UP Philippine General Hospital'
        ) total_pgh_2) t_noncore
FROM DUAL

]]>
</sqlStatement>

</dataQuery>

<dataStructure>
  <group source="Q_HEADER"  name="G_HEADER">

      <element value="cu" name="cu"/>
      <element value="eff_date" name="eff_date"/>
      <element value="seq" name="seq"/>

      <element value="t_npgh" name="t_npgh"/>
      <element value="t_pgh" name="t_pgh"/>

      <element value="t_noncore" name="t_noncore"/>
      


      <element value="fac" function="sum" name="tfac"/>    
      <element value="admin" function="sum" name="tadmin"/>    
      <element value="reps" function="sum" name="treps"/>    
      <element value="rfe" function="sum" name="trfe"/>
  

      <group source="Q_PPG" name="G_PPG">
        <element value="cu" name="cu"/>
        <element value="fac" name="fac"/>
        <element value="admin" name="admin"/>
        <element value="reps" name="reps"/>
        <element value="rfe" name="rfe"/>
        <element value="tcu" name="tcu"/> 
      </group>


      <element value="G_CATEG.perm" function="sum" name="tperm"/>    
      <element value="G_CATEG.temp" function="sum" name="ttemp"/>    
      <element value="G_CATEG.subs" function="sum" name="tsubs"/>    
      <element value="G_CATEG.casl" function="sum" name="tcasl"/>
      <element value="G_CATEG.cont" function="sum" name="tcont"/>


      <group source="Q_CATEG" name="G_CATEG">
        <element value="cu" name="cu"/>
        <element value="perm" name="perm"/>
        <element value="temp" name="temp"/>
        <element value="subs" name="subs"/>
        <element value="casl" name="casl"/>
        <element value="cont" name="cont"/> 
        <element value="tcu" name="tcu"/> 
      </group>


      <group source="Q_FAC_CATEG" name="G_FAC_CATEG">
        <element value="cu" name="cu"/>
        <element value="perm" name="perm"/>
        <element value="temp" name="temp"/>
        <element value="subs" name="subs"/>
        <element value="casl" name="casl"/>
        <element value="cont" name="cont"/> 
        <element value="tcu" name="tcu"/> 
      </group>




      <group source="Q_RFE_CATEG" name="G_RFE_CATEG">
        <element value="cu" name="cu"/>
        <element value="perm" name="perm"/>
        <element value="temp" name="temp"/>
        <element value="subs" name="subs"/>
        <element value="casl" name="casl"/>
        <element value="cont" name="cont"/> 
        <element value="tcu" name="tcu"/> 
      </group>


    <group source="Q_ADMIN_CATEG" name="G_ADMIN_CATEG">
      <element value="cu" name="cu"/>
      <element value="perm" name="perm"/>
      <element value="temp" name="temp"/>
      <element value="subs" name="subs"/>
      <element value="casl" name="casl"/>
      <element value="cont" name="cont"/> 
      <element value="tcu" name="tcu"/> 
    </group>



    <group source="Q_REPS_CATEG" name="G_REPS_CATEG">
      <element value="cu" name="cu"/>
      <element value="perm" name="perm"/>
      <element value="temp" name="temp"/>
      <element value="subs" name="subs"/>
      <element value="casl" name="casl"/>
      <element value="cont" name="cont"/> 
      <element value="tcu" name="tcu"/> 
    </group>


    <group source="Q_GENDER" name="G_GENDER">
      <element value="cu" name="cu"/>
      <element value="male" name="male"/>
      <element value="female" name="female"/>
      <element value="tcu" name="tcu"/>
    </group>

    <group source="Q_NONCORE_NO_PGH" name="G_NONCORE_NO_PGH">

        <element value="cu" name="cu"/>
        <element value="lec" name="lec"/>
        <element value="aff" name="aff"/>
        <element value="vis" name="vis"/>
        <element value="adj" name="adj"/>
        <element value="eme" name="eme"/>
        <element value="taf" name="taf"/> 
        

        <element value="ics" name="ics"/>
        <element value="woc" name="woc"/>
        <element value="tiw" name="tiw"/> 

        <element value="tnc" name="tnc"/> 


        

    </group>




    <group source="Q_NONCORE_PGH" name="G_NONCORE_PGH">
      <element value="cu" name="cu"/>
      <element value="lec" name="lec"/>
      <element value="aff" name="aff"/>
      <element value="vis" name="vis"/>
      <element value="adj" name="adj"/>
      <element value="eme" name="eme"/>
      <element value="taf" name="taf"/>         
      
      <element value="ics" name="ics"/>
      <element value="woc" name="woc"/>
      <element value="tiw" name="tiw"/> 


      <element value="tnc" name="tnc"/> 
    </group>
     
    
  

    
  </group>



</dataStructure>
</dataTemplate>